doctype 5
html lang="en"
  head
    meta charset="UTF-8"
    title 欢乐诵渠道管理平台
    = csrf_meta_tags
    script src="/js/jquery.min.js"
  body
    hr align="center" size='3' style="background:#ff5c5c;margin-bottom:125px"
    h2.h1 欢乐诵渠道管理平台
    p.p align='center'
      span 登录
    = form_tag channel_session_url, method: :post, id: "form1",name:"form1"  do
      p
        = text_field_tag :email, '',placeholder:'Account or Email'

      p
        = password_field_tag :password,'',placeholder:'Passwordaa'

      p
        = text_field_tag :phone,'',placeholder:'Phone number'

      p
        label for="code"
        = text_field_tag :code, '', placeholder:'code', style:'width:173px;height:50px'
        button#send_verify name="send_verify" 获取验证码
      P
        = submit_tag :submit, style:'width:310px;background-color:#ef4141;color:#FFFFFF;font-size: 20px;outline:none;', value:"登录"


    link href="/css/login.css" rel="stylesheet" type="text/css"

javascript:
  $("#code").keyup(function(event){
    if (event.keyCode == 13)
    {
      $("input[type == 'submit']").click();
      return false;
    }
  });
  var countdown=60;
  function settime(obj) {
      if (countdown == 0) {
          obj.removeAttr("disabled");
          obj.css({"background-color":"#ef4141", "color": "#FFFFFF"});
          obj.text("获取验证码");
          countdown = 60;
          return;
      } else {
          obj.attr("disabled", "disabled");
          obj.css({"background-color": "#908f8f"})
          console.log('aaa');
          obj.text("重新发送(" + countdown + ")");
          countdown--;
    }
      setTimeout(function() {
        settime(obj) }
        ,1000)
    }

  $("#send_verify").click(function(event){
    var phone = $("#phone").val();
    var data = {
      phone: phone
    }
    $.ajax({
      url: '/api/v1/channel_users/getcode',
      method: "GET",
      dataType: "json",
      data: data,
      success: function(data){
        console.log(data.message);
      }
    })
    settime($("#send_verify"));
    event.preventDefault();

  });

  
